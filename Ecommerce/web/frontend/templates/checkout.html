<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <!--=====================================
                    META TAG PART START
        =======================================-->
    <!-- REQUIRE META -->
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- AUTHOR META -->
    <meta name="author" content="mironcoder" />
    <meta name="email" content="mironcoder@gmail.com" />
    <meta name="profile" content="https://themeforest.net/user/mironcoder" />

    <!-- TEMPLATE META -->
    <meta name="name" content="Nebula" />
    <meta name="title" content="Nebula - eCommerce HTML Template" />
    <meta
      name="keywords"
      content="organic, food, shop, ecommerce, store, html, bootstrap, template, agriculture, vegetables, webshop, farm, grocery, natural, online store"
    />
    <!--=====================================
                    META-TAG PART END
        =======================================-->

    <!-- WEBPAGE TITLE -->
    <title>Nebula - Checkout</title>

    <!--=====================================
                    CSS LINK PART START
        =======================================-->
    <!-- FAVICON -->
    <link
      rel="icon"
      href="{{url_for('static', filename='images/favicon.png')}}"
    />

    <!-- FONTS -->
    <link
      rel="stylesheet"
      href="{{url_for('static', filename='fonts/flaticon/flaticon.css')}}"
    />
    <link
      rel="stylesheet"
      href="{{url_for('static', filename='fonts/icofont/icofont.min.css')}}"
    />
    <link
      rel="stylesheet"
      href="{{url_for('static', filename='fonts/fontawesome/fontawesome.min.css')}}"
    />

    <!-- VENDOR -->
    <link
      rel="stylesheet"
      href="{{url_for('static', filename='vendor/venobox/venobox.min.css')}}"
    />
    <link
      rel="stylesheet"
      href="{{url_for('static', filename='vendor/slickslider/slick.min.css')}}"
    />
    <link
      rel="stylesheet"
      href="{{url_for('static', filename='vendor/niceselect/nice-select.min.css')}}"
    />
    <link
      rel="stylesheet"
      href="{{url_for('static', filename='vendor/bootstrap/bootstrap.min.css')}}"
    />

    <!-- CUSTOM -->
    <link
      rel="stylesheet"
      href="{{url_for('static', filename='css/main.css')}}"
    />
    <link
      rel="stylesheet"
      href="{{url_for('static', filename='css/checkout.css')}}"
    />

    <script>
      function selectCard(cardID) {
        // get all payment-card elements
        const cards = document.querySelectorAll(".payment-card");

        // loop through all payment-card elements
        cards.forEach(function (card) {
          // remove the active class from all payment-card elements
          card.classList.remove("active");
        });

        // get the payment-card element for the selected card
        const selectedCard = document.querySelector(
          `[data-card-id="${cardID}"]`
        );

        // add the active class to the payment-card element for the selected card
        selectedCard.classList.add("active");

        var input = document.getElementById("cardId");
        input.value = cardID;
      }
    </script>

    {% if 'cartErro' in session%}
    <script>
      window.onload = function () {
        $("#cardError").modal("show");

        setTimeout(function () {
          $("#cardError").modal("hide");
        }, 2000);
      };
    </script>
    {% endif %}

    <!--=====================================
                    CSS LINK PART END
        =======================================-->
  </head>
  <body>
    <div class="backdrop"></div>
    <a class="backtop fas fa-arrow-up" href="#"></a>

    <!--=====================================
                    HEADER PART START
        =======================================-->
    <header class="header-part">
      <div class="container">
        <div class="header-content">
          <div class="header-media-group">
            <button class="header-user">
              <img src="static/images/user.png" alt="user" />
            </button>
            <a href="{{url_for('views.shop')}}"
              ><img src="static/images/logo.png" alt="logo"
            /></a>
            <button class="header-src"><i class="fas fa-search"></i></button>
          </div>

          <a href="{{url_for('views.shop')}}" class="header-logo">
            <img src="static/images/logo.png" alt="logo" />
          </a>

          <ul class="dropdown">
            <a class="navbar-link dropdown-arrow" href="#">My Account</a>
            <ul class="dropdown-position-list">
              <li><a href="{{url_for('views.profile')}}">Account Info</a></li>
              <li><a href="{{url_for('views.orders')}}">My Orders</a></li>
              <li><a href="{{url_for('auth.logout')}}">Logout</a></li>
            </ul>
          </ul>

          <form class="header-form">
            <input type="text" placeholder="Search anything..." />
            <button><i class="fas fa-search"></i></button>
          </form>

          <div class="header-widget-group"></div>
        </div>
      </div>
    </header>
    <!--=====================================
                    HEADER PART END
        =======================================-->

    <!--=====================================
                    BANNER PART START
        =======================================-->
    <section
      class="inner-section single-banner"
      style="background: url(images/single-banner.jpg) no-repeat center"
    >
      <div class="container">
        <h2>checkout</h2>
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a href="{{url_for('views.shop')}}">shop</a>
          </li>
          <li class="breadcrumb-item active" aria-current="page">checkout</li>
        </ol>
      </div>
    </section>
    <!--=====================================
                    BANNER PART END
        =======================================-->

    <!--=====================================
                    CHECKOUT PART START
        =======================================-->
    <section class="inner-section checkout-part">
      <div class="container">
        <div class="row">
          <div class="col-lg-12">
            <div class="account-card">
              <div class="account-title">
                <h4>Your order</h4>
              </div>
              <div class="account-content">
                <div class="table-scroll">
                  <table class="table-list">
                    <thead>
                      <tr>
                        <th scope="col">Product</th>
                        <th scope="col">Name</th>
                        <th scope="col">Price</th>
                        <th scope="col">Quantity</th>
                        <th scope="col">Total Price</th>
                        <th scope="col">action</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% if 'cart' in session %} {% for item in CartItems %}

                      <tr>
                        <td class="table-image">
                          <img
                            src="static/images/product-images/{{item['image']}}"
                            alt="product"
                          />
                        </td>
                        <td class="table-name"><h6>{{item['name']}}</h6></td>
                        <td class="table-price">
                          <h6>${{item['price']}}0</h6>
                        </td>
                        <td class="table-brand">
                          <h6>{{item['quantity']}}</h6>
                        </td>
                        <td class="table-brand">
                          <h6>${{item['quantity'] * item['price']}}</h6>
                        </td>
                        <td class="table-action">
                          <a
                            class="view"
                            href="#"
                            title="Edit Amount"
                            data-bs-toggle="modal"
                            data-bs-target="#product-view-{{item['id']}}"
                            ><i class="fas fa-edit"></i
                          ></a>

                          <form
                            action="{{url_for('views.deleteCheckout')}}"
                            method="POST"
                          >
                            <button class="trash">
                              <i class="icofont-trash"></i>
                            </button>
                            <input
                              type="hidden"
                              name="itemId"
                              id="itemId"
                              value="{{item['id']}}"
                            />
                          </form>
                        </td>
                      </tr>

                      <div class="modal fade" id="product-view-{{item['id']}}">
                        <div class="modal-dialog">
                          <div class="modal-content">
                            <div
                              class="card mb-3"
                              style="width: 80%; left: 10%"
                            >
                              <button
                                class="modal-close icofont-close"
                                data-bs-dismiss="modal"
                              ></button>
                              <div class="row g-0">
                                <div class="col-md-4">
                                  <img
                                    src="static/images/product-images/{{item['image']}}"
                                    class="img-fluid rounded-start"
                                    alt="product"
                                    style="
                                      width: 100%;
                                      height: 100%;
                                      max-height: 500px;
                                      object-fit: contain;
                                      pointer-events: none;
                                    "
                                  />
                                </div>
                                <div class="col-md-8">
                                  <div
                                    class="card-body"
                                    style="padding-left: 20%"
                                  >
                                    <h5 class="card-title">
                                      <label class="view-label new"
                                        >{{item['stock']}} in stock</label
                                      >
                                    </h5>
                                    <h3 class="card-title">{{item['name']}}</h3>
                                    <h4 class="card-title">
                                      <span>Price: {{item['price']}}0</span>
                                    </h4>

                                    <p class="card-text">
                                      <span style="font-weight: bold"
                                        >Brand:</span
                                      >
                                      {{item['brand']}}
                                    </p>

                                    <p class="card-text">
                                      <span style="font-weight: bold"
                                        >Type:</span
                                      >
                                      {{item['type']}}
                                    </p>

                                    <p class="card-text">
                                      <span style="font-weight: bold"
                                        >Mount:</span
                                      >
                                      {{item['mount']}}
                                    </p>
                                    <p class="card-text">
                                      <span style="font-weight: bold"
                                        >Focal Distance:</span
                                      >
                                      {{item['focal_distance']}}
                                    </p>
                                    <p>
                                      <span style="font-weight: bold"
                                        >Aperture:</span
                                      >
                                      {{item['aperture']}}
                                    </p>
                                    <p class="card-text">
                                      {{item['description']}}
                                    </p>

                                    {% if 'customer' in session%}
                                    <form
                                      action="{{url_for('views.editCheckout')}}"
                                      method="POST"
                                    >
                                      <input
                                        type="hidden"
                                        value="{{item['id']}}"
                                        name="p_idModal"
                                        id="p_idModal"
                                      />
                                      <div class="view-add-group">
                                        <button
                                          class="product-add"
                                          type="button"
                                        >
                                          <span>Tap to edit amount</span>
                                        </button>
                                        <div class="product-action">
                                          <button
                                            class="action-minus"
                                            title="Quantity Minus"
                                            type="button"
                                          >
                                            <i class="icofont-minus"></i>
                                          </button>
                                          <input
                                            class="action-input"
                                            title="Quantity Number"
                                            type="text"
                                            name="quantity"
                                            value="{{item['quantity']}}"
                                          />
                                          <button
                                            class="action-plus"
                                            title="Quantity Plus"
                                            type="button"
                                          >
                                            <i class="icofont-plus"></i>
                                          </button>
                                        </div>
                                      </div>
                                      <div class="view-action-group">
                                        <button
                                          class="view-wish wish"
                                          type="submit"
                                        >
                                          <span>Save</span>
                                        </button>
                                      </div>
                                    </form>
                                    {% endif %}
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      {% endfor %} {% endif %}
                    </tbody>
                  </table>
                </div>
                <br /><br />
                <div class="checkout-charge">
                  <ul>
                    <li>
                      <span>Total</span>
                      <span>${{session['cartTotalPrice']}}.00</span>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>

          <div class="col-lg-12">
            <div class="account-card">
              <div class="account-title">
                <h4>contact number</h4>
                <button data-bs-toggle="modal" data-bs-target="#contact-add">
                  edit number
                </button>
              </div>
              <div class="account-content">
                <div class="row">
                  <div class="col-md-6 col-lg-4 alert fade show">
                    <div class="profile-card contact active">
                      <h6>primary</h6>
                      <p>{{user1[4]}}</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-12">
            <div class="account-card">
              <div class="account-title">
                <h4>delivery address</h4>
                <button data-bs-toggle="modal" data-bs-target="#address-add">
                  edit address
                </button>
              </div>
              <div class="account-content">
                <div class="row">
                  <div class="col-md-6 col-lg-4 alert fade show">
                    <div class="profile-card address active">
                      <p>{{user1[5]}}</p>
                      <br />
                      <p>{{user1[6]}}</p>
                      <br />
                      <p>{{user1[8]}}, {{user1[9]}} &nbsp {{user1[7]}}</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-12">
            <div class="account-card mb-0">
              <div class="account-title">
                <h4>payment option</h4>
                <form
                  action="{{url_for('views.saveSelectedCard')}}"
                  method="POST"
                >
                  {% if 'cardId' in session%}
                  <input
                    type="hidden"
                    value="{{cardId}}"
                    id="cardId"
                    name="cardId"
                  />
                  {% else %}
                  <input type="hidden" value="card" id="cardId" name="cardId" />
                  {% endif %}
                  <button type="submit">save selected card</button>
                </form>
                <button data-bs-toggle="modal" data-bs-target="#payment-add">
                  add payment info
                </button>
              </div>
              <div class="account-content">
                <div class="row">
                  {% for c in card %}
                  <div class="col-md-6 col-lg-4 alert fade show">
                    {% if cardId == c[0]%}
                    <div class="payment-card active" data-card-id="{{c[0]}}">
                      <h2>{{c[1]}}</h2>
                      <p>{{c[2]}}</p>
                      <h5 class="card-number">{{c[3]}}</h5>
                      <h6>{{c[4]}} / {{c[5]}}</h6>

                      <button onclick="selectCard('{{c[0]}}')">
                        Select Card
                      </button>
                    </div>
                    {% else %}
                    <div class="payment-card" data-card-id="{{c[0]}}">
                      <h2>{{c[1]}}</h2>
                      <p>{{c[2]}}</p>
                      <h5 class="card-number">{{c[3]}}</h5>
                      <h6>{{c[4]}} / {{c[5]}}</h6>

                      <button onclick="selectCard('{{c[0]}}')">
                        Select Card
                      </button>
                    </div>
                    {% endif %}
                  </div>
                  {% endfor %}
                </div>
              </div>
            </div>
          </div>

          <!-- contact add form -->
          <div class="modal fade" id="contact-add">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">
                <button class="modal-close" data-bs-dismiss="modal">
                  <i class="icofont-close"></i>
                </button>
                <form class="modal-form">
                  <div class="form-title">
                    <h3>Edit contact number</h3>
                  </div>
                  <div class="form-group">
                    <label class="form-label">number</label>
                    <input
                      class="form-control"
                      type="number"
                      value="{{user1[10]}}"
                    />
                  </div>
                  <button class="form-btn" type="submit">
                    save contact number
                  </button>
                </form>
              </div>
            </div>
          </div>

          <!-- address add form -->
          <div class="modal fade" id="address-add">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">
                <button class="modal-close" data-bs-dismiss="modal">
                  <i class="icofont-close"></i>
                </button>
                <form
                  name="form2"
                  class="modal-form"
                  action="{{url_for('views.editinfo')}}"
                  method="post"
                >
                  <div class="form-title">
                    <h3>edit address info</h3>
                  </div>

                  <div class="form-group">
                    <label class="form-label">Address Line 1</label>
                    <input
                      type="text"
                      name="aline1"
                      class="form-control"
                      value="{{user1[5]}}"
                    />
                  </div>
                  <div class="form-group">
                    <label class="form-label">Address Line 2</label>
                    <input
                      type="text"
                      name="aline2"
                      class="form-control"
                      value="{{user1[6]}}"
                    />
                  </div>
                  <div class="form-group">
                    <label class="form-label">City</label>
                    <input
                      type="text"
                      name="city"
                      class="form-control"
                      value="{{user1[8]}}"
                    />
                  </div>
                  <div class="form-group">
                    <label class="form-label">State</label>
                    <input
                      type="text"
                      name="state"
                      class="form-control"
                      value="{{user1[9]}}"
                    />
                  </div>
                  <div class="form-group">
                    <label class="form-label">Zipcode</label>
                    <input
                      type="text"
                      name="zipcode"
                      class="form-control"
                      value="{{user1[7]}}"
                    />
                    <input type="hidden" name="form_name" value="form2" />
                  </div>
                  <button class="form-btn" type="submit">
                    save address info
                  </button>
                  <input type="hidden" name="page" value="/profile" />
                </form>
              </div>
            </div>
          </div>

          <!-- payment add form -->
          <div class="modal fade" id="payment-add">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">
                <button class="modal-close" data-bs-dismiss="modal">
                  <i class="icofont-close"></i>
                </button>
                <form class="modal-form">
                  <div class="form-title">
                    <h3>edit payment info</h3>
                  </div>
                  <div class="form-group">
                    <label class="form-label">card name</label>
                    <input
                      class="form-control"
                      type="text"
                      value="{{user1[11]}}"
                    />
                  </div>
                  <div class="form-group">
                    <label class="form-label">card number</label>
                    <input
                      class="form-control"
                      type="number"
                      value="{{user1[13]}}"
                    />
                  </div>
                  <div class="form-group">
                    <label class="form-label">card type</label>
                    <input
                      class="form-control"
                      type="text"
                      value="{{user1[12]}}"
                    />
                  </div>
                  <div class="form-group">
                    <label class="form-label"
                      >expiration date (MM/DD/YYYY)</label
                    >
                    <input
                      class="form-control"
                      type="date"
                      value="{{user1[14]}}"
                    />
                  </div>
                  <button class="form-btn" type="submit">
                    save payment info
                  </button>
                </form>
              </div>
            </div>
          </div>

          <div class="modal fade" id="cardError">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="card" style="border-radius: 5px">
                  <div class="card-body">
                    <h5 class="card-title" style="text-align: center">
                      No payment selected
                    </h5>
                    <p class="card-text">Please select a payment method</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="checkout-proced">
            <a href="{{url_for('views.procesOrder')}}" class="btn btn-inline"
              >proceed to checkout</a
            >
          </div>
        </div>
      </div>
    </section>
    <!--=====================================
                    CHECKOUT PART END
        =======================================-->

    <!--=====================================
                     FOOTER PART START
        =======================================-->
    <footer style="background-color: gray" class="footer-part">
      <div class="container">
        <div class="row">
          <div class="col-sm-6 col-xl-3">
            <div class="footer-widget">
              <a class="footer-logo" href="#">
                <img src="images/logo.png" alt="logo" />
              </a>
              <p class="footer-desc">
                This e-commerce template has been created for the sole purpose
                of aiding the students for the Databases course
              </p>
            </div>
          </div>
          <div class="col-sm-6 col-xl-3">
            <div class="footer-widget contact">
              <h3 class="footer-title">contact us</h3>
              <ul class="footer-contact">
                <li>
                  <i class="icofont-ui-email"></i>
                  <p>
                    <span>javier.quinones3@upr.edu</span>
                    <span>eliana.valenzuela@upr.edu</span>
                  </p>
                </li>
                <li>
                  <i class="icofont-ui-touch-phone"></i>
                  <p>
                    <span>+787 597 7369</span>
                    <span>N/A</span>
                  </p>
                </li>
              </ul>
            </div>
          </div>
          <div class="col-sm-6 col-xl-3">
            <div class="footer-widget">
              <h3 class="footer-title">Quick Links</h3>
              <div class="footer-links">
                <ul>
                  <li><a href="https://github.com/CCOM-UPRA">Github</a></li>
                  <li><a href="http://upra.edu/">upra.edu</a></li>
                  <li>
                    <a
                      href="https://cursos.upra.edu/course/search.php?areaids=core_course-course&q=ccom4115-ME5"
                      >cursos.upra.edu</a
                    >
                  </li>
                </ul>
                <ul>
                  <li>
                    <a href="https://www.youtube.com/watch?v=Z1RJmh_OqeA"
                      >Flask tutorial</a
                    >
                  </li>
                  <li>
                    <a href="https://www.youtube.com/watch?v=qz0aGYrrlhU"
                      >HTML tutorial</a
                    >
                  </li>
                  <li>
                    <a href="https://www.youtube.com/watch?v=kqtD5dpn9C8"
                      >Python tutorial</a
                    >
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="col-sm-6 col-xl-3">
            <div class="footer-widget">
              <h3 class="footer-title">Students of CCOM4115</h3>
              <p class="footer-desc">
                Do not hesitate to reach out to the professor or TA with any
                questions.
              </p>
            </div>
          </div>
        </div>
        <br />
      </div>
    </footer>
    <!--=====================================
                      FOOTER PART END
        =======================================-->

    <!--=====================================
                    JS LINK PART START
        =======================================-->
    <!-- VENDOR -->
    <script src="{{url_for('static', filename='vendor/bootstrap/jquery-1.12.4.min.js')}}"></script>
    <script src="{{url_for('static', filename='vendor/bootstrap/popper.min.js')}}"></script>
    <script src="{{url_for('static', filename='vendor/bootstrap/bootstrap.min.js')}}"></script>
    <script src="{{url_for('static', filename='vendor/countdown/countdown.min.js')}}"></script>
    <script src="{{url_for('static', filename='vendor/niceselect/nice-select.min.js')}}"></script>
    <script src="{{url_for('static', filename='vendor/slickslider/slick.min.js')}}"></script>
    <script src="{{url_for('static', filename='vendor/venobox/venobox.min.js')}}"></script>

    <!-- CUSTOM -->
    <script src="{{url_for('static', filename='js/nice-select.js')}}"></script>
    <script src="{{url_for('static', filename='js/countdown.js')}}"></script>
    <script src="{{url_for('static', filename='js/accordion.js')}}"></script>
    <script src="{{url_for('static', filename='js/venobox.js')}}"></script>
    <script src="{{url_for('static', filename='js/slick.js')}}"></script>
    <script src="{{url_for('static', filename='js/main.js')}}"></script>
    <!--=====================================
                    JS LINK PART END
        =======================================-->
  </body>
</html>
